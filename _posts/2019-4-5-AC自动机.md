---
layout: post
title: 2019-4-5 AC自动机

date: 2019-4-5
categories: blog
tags: [,]
description: 
---

---------------------

```c++
inline void init(){
	For(i,0,siz + 1)	{
		memset(AC[i].ch,0,sizeof(AC[i].ch));
		AC[i].fail = AC[i].val = 0;
	}	
	siz = 0;
}
inline void insert(char s[],int len,int id){
	int u = 0;
	For(i,0,len){
		if (!AC[u].ch[s[i] - 'a'])	AC[u].ch[s[i] - 'a'] = ++siz;
		u = AC[u].ch[s[i] - 'a'];
	}
	AC[u].val = id;
}
inline void build_fail(){
	queue<int> Q;
	For(i,0,26)	if (AC[0].ch[i]){
		Q.push(AC[0].ch[i]);
		AC[AC[0].ch[i]].fail = 0;
	}
	while(!Q.empty()){
		int u = Q.front();Q.pop();
		For(i,0,26)	{
			if (AC[u].ch[i]){
				AC[AC[u].ch[i]].fail = AC[AC[u].fail].ch[i];
				Q.push(AC[u].ch[i]);
			}else AC[u].ch[i] = AC[AC[u].fail].ch[i];
		}	
	}
}
int ans[MAXN];
inline void compare(char s[],int len){
	int u = 0;
	For(i,0,len){
		u = AC[u].ch[s[i] - 'a'];	
		for (int j = u;j;j = AC[j].fail)	ans[AC[j].val]++;
	}
}
```
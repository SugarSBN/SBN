---
layout: post
title: 2019-4-5 SAM

date: 2019-4-5
categories: blog
tags: [,]
description: 
---

---------------------

```c++
void insert(char c){
	int cur = ++siz;
	SAM[cur].cnt = 1;
	SAM[cur].len = SAM[lst].len + 1;
	int p = lst;lst = cur;
	while(p != -1 && !SAM[p].ch[c - 'a'])	{
		SAM[p].ch[c - 'a'] = cur;
		p = SAM[p].link;
	}	
	if (p == -1){
		SAM[cur].link = 0;
	}else{
		int q = SAM[p].ch[c - 'a'];
		if (SAM[q].len == SAM[p].len + 1){
			SAM[cur].link = q;
		}else{
			int np = ++siz;
			SAM[np] = SAM[q];
			SAM[np].cnt = 0;
			SAM[np].len = SAM[p].len + 1;
			while(p != -1 && SAM[p].ch[c - 'a'] == q){
				SAM[p].ch[c - 'a'] = np;
				p = SAM[p].link;
			}
			SAM[q].link = SAM[cur].link = np;
		}
	}
}
```
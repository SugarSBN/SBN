---
layout: post
title: 2019-2-24 exBSGS算法

date: 2019-2-24
categories: blog
tags: [数论,exBSGS]
description: 
---

---------------------


突然发现自己忘了exBSGS怎么写的了赶紧记录下来


首先这个算法是用于计算形如<a href="https://www.codecogs.com/eqnedit.php?latex=A^{x}&space;\equiv&space;B(modP)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A^{x}&space;\equiv&space;B(modP)" title="A^{x} \equiv B(modP)" /></a>这样的方程，A,B,P已知，求解最小的x

首先我们关注下A与P互质的情况

然后我们可以改写成这样<a href="https://www.codecogs.com/eqnedit.php?latex=A^{\alpha&space;t-\beta&space;}&space;\equiv&space;B(modP)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A^{\alpha&space;t-\beta&space;}&space;\equiv&space;B(modP)" title="A^{\alpha t-\beta } \equiv B(modP)" /></a>
然后t是我们自己定义的一个数。那么我们只需要求解alpha 和beta就好了

当
<a href="https://www.codecogs.com/eqnedit.php?latex=t=\sqrt{P}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?t=\sqrt{P}" title="t=\sqrt{P}" /></a>
时
等价于求<a href="https://www.codecogs.com/eqnedit.php?latex=A^{\alpha&space;t}\equiv&space;B^{\beta&space;}&space;C(mod&space;P)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A^{\alpha&space;t}\equiv&space;B^{\beta&space;}&space;C(mod&space;P)" title="A^{\alpha t}\equiv B^{\beta } C(mod P)" /></a>

我们可以枚举0 —— sqrt(P)中的beta，然后把C * B ^ beta	hash储存，然后在枚举alpha即可



如果A,P不互质呢。。？

可以尝试转化为原来的问题
令
<a href="https://www.codecogs.com/eqnedit.php?latex=g&space;=&space;gcd(A,P)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?g&space;=&space;gcd(A,P)" title="g = gcd(A,P)" /></a>
若g不整除B，那么是无解的返回-1

否则

---
layout: post
title: 2019-4-5 卷积合集

date: 2019-4-5
categories: blog
tags: [,]
description: 
---

---------------------

# FFT:
```c++
void change(complex<dbl> X[],int len){
	For(i,0,(1 << len)){
		id[i] = 0;
		For(j,0,len){
			int p1 = i >> j & 1;
			int p2 = i >> (len - j - 1) & 1;
			id[i] |= p1 << (len - j - 1);
			id[i] |= p2 << j; 
		}
	}
	For(i,0,(1 << len))	tp[i] = X[i];
	For(i,0,(1 << len))	X[i] = tp[id[i]];
}
void FFT(complex<dbl> X[],int len,int inv){
	change(X,len);
	for (int l = 2;l <= (1 << len);l <<= 1){
		complex<dbl> Wn = {cos(2 * pi / l),sin(2 * pi * inv / l)};
		for (int i = 0;i < (1 << len);i += l){
			complex<dbl> W = {1.0,0};
			For(j,i,i + l / 2){
				complex<dbl> x = X[j];
				complex<dbl> y = W * X[j + l / 2];
				X[j] = x + y;
				X[j + l / 2] = x - y;
				W *= Wn;
			}
		}
	}
	if (inv == -1)	For(i,0,(1 << len))	X[i].real(X[i].real() / (1 << len));
}
FFT(A,len,1);FFT(B,len,1);
For(i,0,(1 << len))	A[i] *= B[i];
FFT(A,len,-1);
For(i,0,(n - 1) + (m - 1) + 1)	printf("%d ",(int)(A[i].real() + 0.5));
```
# NTT:
```c++
void change(int A[],int len){
	For(i,0,(1 << len)){
		id[i] = 0;
		For(j,0,len){
			int p1 = i >> j & 1;
			int p2 = i >> (len - j - 1) & 1;
			id[i] |= p2 << j;
			id[i] |= p1 << (len - j - 1); 
		}
	}
	For(i,0,(1 << len)) tp[i] = A[i];
	For(i,0,(1 << len))	A[i] = tp[id[i]];
}
void NTT(int A[],int len,int inv){
	change(A,len);
	for (int l = 2;l <= (1 << len);l <<= 1){
		int Gn = qpow(3,(MOD - 1) / l);
		if (inv == -1)	Gn = qpow(Gn,MOD - 2);
		for (int i = 0;i < (1 << len);i += l){
			int G = 1;
			For(j,i,i + l / 2){
				int x = A[j];
				int y = (ll)A[j + l / 2] * G % MOD;
				A[j] = (x + y) % MOD;
				A[j + l / 2] = ((x - y) % MOD + MOD) % MOD;
				G = (ll)G * Gn % MOD;
			}
		}
	}
}
NTT(A,len,1);NTT(B,len,1);
For(i,0,(1 << len)) A[i] = (ll)A[i] * B[i] % MOD;
NTT(A,len,-1);
int inv = qpow((1 << len),MOD - 2);
For(i,0,(n + m - 1))	printf("%d ",(ll)A[i] * inv % MOD);
```

# FWT:
```c++
inline void FWT_and(int X[],int inv){
	change(X);
	for (int l = 2;l <= (1 << len);l <<= 1){
		for (int i = 0;i < (1 << len);i += l){
			For(j,i,i + l / 2){
				if (inv == 1)	X[j] = (X[j] + X[j + l / 2]) % MOD;
				else X[j] = (X[j] - X[j + l / 2] + MOD) % MOD;
			}
		}
	}
}
inline void FWT_or(int X[],int inv){
	change(X);
	for (int l = 2;l <= (1 << len);l <<= 1){
		for (int i = 0;i < (1 << len);i += l){
			For(j,i,i + l / 2){
				if (inv == 1)	X[j + l / 2] = (X[j] + X[j + l / 2]) % MOD;
				else X[j + l / 2] = (X[j + l / 2] - X[j] + MOD) % MOD;
			}
		}
	}
}
inline void FWT_xor(int X[],int inv){
	change(X);
	for (int l = 2;l <= (1 << len);l <<= 1){
		for (int i = 0;i < (1 << len);i += l){
			For(j,i,i + l / 2){
				int x = X[j],y = X[j + l / 2];
				X[j] = (x + y) % MOD;
				X[j + l / 2] = (x - y + MOD) % MOD;
				if (inv == -1){
					X[j] = (ll)X[j] * inv2 % MOD;
					X[j + l / 2] = (ll)X[j + l / 2] * inv2 % MOD;
				}
			}
		}
	}
}
```